[
	{
		"object_type": "discovery",
		"discovery_type": "active_directory",
		"discovery_object_type": "instance",
		"name": "discovery_domain_local",
		"ldap_url": "ldap://0.0.0.0",
		"ldap_dn": "$(resources.ldap_dn)",
		"ldap_password": "$(resources.ldap_password)",
		"ldap_scope": "SCOPE_SUBTREE",
		"ldap_refresh_seconds": 600,
		"ldap_filter": {
			"objectClass": {
				"eq": "computer"
			},
			"lastLogonTimestamp": {
				"ge": {
					"Fn::adsecondsfromnow": [
						"31536000"
					]
				}
			}
		},
		"ldap_attrlist": [
			"dn",
			"dNSHostName",
			"cn"
		],
		"ldap_attribute_tags": {
			"fqdn": "dNSHostName",
			"dn": "dn"
		},
		"ldap_attribute_object_map": {
			"name": "cn",
			"alias": "cn",
			"display_name": "cn",
			"address": "dNSHostName"
		},
		"register": false
	},
	{
		"object_type": "command",
		"name": "ping",
		"type": "samm.pingmodule.PingModule",
		"args": {
			"hostaddress": "$(instance.address)",
			"count": "$(check.count)",
			"timeout": "$(check.timeout)"
		}
	},
	{
		"object_type": "discovery",
		"test_file": "tests/ldap_discovery_data.py",
		"use": "discovery_domain_local",
		"name": "all",
		"ldap_base": "DC=domain,DC=local",
		"object_use": [ 
			"template_host"
		],
		"tags": {
			"layer": "test"
		}
	},
	{
		"object_type": "instance",
		"name": "template_host",
		"checks": [
			"ping"
		],
		"up_check": "ping.is_alive",
		"check_if_down": false,
		"stale_timeout": 432000,
		"register": false
	},
	{
		"object_type": "check",
		"name": "ping",
		"command": "ping",
		"check_interval": 30,
		"stale_timeout": 45,
		"count": 2,
		"timeout": 1,
		"tag_properties": [
			"hostaddress",
			"address"
		],
		"metrics": [
			"min_rtt",
			"avg_rtt",
			"max_rtt",
			"packets_sent",
			"packets_received",
			"is_alive"
		]
	}
]